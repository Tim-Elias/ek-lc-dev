{"ast":null,"code":"var _jsxFileName = \"/home/saint/ek 3.1/ek-lc-dev/src/m_screen/foto.js\";\nimport React from 'react';\nimport CameraPhoto, { FACING_MODES } from 'jslib-html5-camera-photo';\nimport { connect } from 'react-redux';\nimport './mobile.css';\nimport foto from '../common/foto.png';\n\nclass Screen extends React.Component {\n  constructor(props, context) {\n    super(props, context);\n    this.cameraPhoto = null;\n    this.videoRef = /*#__PURE__*/React.createRef();\n  }\n\n  componentDidMount() {\n    this.cameraPhoto = new CameraPhoto(this.videoRef.current);\n  }\n\n  componentWillUnmount() {\n    this.stopCamera();\n    this.props.take_foto('');\n  }\n\n  startCamera(idealFacingMode, idealResolution) {\n    this.cameraPhoto.startCamera(idealFacingMode, idealResolution).then(() => {\n      console.log('camera is started !');\n    }).catch(error => {\n      console.error('Camera not started!', error);\n    });\n    this.props.camera_active(true);\n  }\n\n  takePhoto() {\n    const config = {\n      sizeFactor: 1\n    };\n    let dataUri = this.cameraPhoto.getDataUri(config);\n    this.props.take_foto(dataUri);\n    this.stopCamera();\n  }\n\n  stopCamera() {\n    this.props.camera_active(false);\n    this.cameraPhoto.stopCamera().then(() => {\n      console.log('Camera stoped!');\n    }).catch(error => {\n      console.log('No camera to stop!:', error);\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mobile_container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mobile_button_container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: this.props.store.disp.cameraActive || this.props.store.disp.foto ? 'none' : 'camera_button',\n      onClick: () => {\n        let facingMode = FACING_MODES.ENVIRONMENT;\n        let idealResolution = {\n          width: 1280,\n          height: 1280\n        };\n        this.props.camera_active(true);\n        this.startCamera(facingMode, idealResolution);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 21\n      }\n    }, \"\\u0412\\u043A\\u043B\\u044E\\u0447\\u0438\\u0442\\u044C \\u041A\\u0430\\u043C\\u0435\\u0440\\u0443\"), /*#__PURE__*/React.createElement(\"button\", {\n      className: this.props.store.disp.cameraActive ? 'camera_button' : 'none',\n      onClick: () => {\n        this.stopCamera();\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 21\n      }\n    }, \"\\u0412\\u044B\\u043A\\u043B\\u044E\\u0447\\u0438\\u0442\\u044C \\u041A\\u0430\\u043C\\u0435\\u0440\\u0443\"), /*#__PURE__*/React.createElement(\"button\", {\n      className: this.props.store.disp.foto ? 'camera_button' : 'none',\n      onClick: () => {\n        let facingMode = FACING_MODES.ENVIRONMENT;\n        let idealResolution = {\n          width: 1280,\n          height: 1280\n        };\n        this.props.take_foto('');\n        this.props.camera_active(true);\n        this.startCamera(facingMode, idealResolution);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 21\n      }\n    }, \"\\u041F\\u0435\\u0440\\u0435\\u0441\\u043D\\u044F\\u0442\\u044C\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: this.props.store.disp.cameraActive ? \"video_container\" : \"none\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"video\", {\n      className: this.props.store.disp.cameraActive ? \"foto\" : \"none\",\n      ref: this.videoRef,\n      autoPlay: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(\"img\", {\n      className: this.props.store.disp.cameraActive ? \"video_button\" : \"none\",\n      src: foto,\n      onClick: () => {\n        this.takePhoto();\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 21\n      }\n    })), /*#__PURE__*/React.createElement(\"img\", {\n      className: \"foto\",\n      src: this.props.store.disp.foto,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 17\n      }\n    }));\n  }\n\n}\n\nexport default connect(state => ({\n  store: state\n}), dispatch => ({\n  take_foto: param => {\n    dispatch({\n      type: 'set_disp_foto',\n      payload: param\n    });\n  },\n  camera_active: param => {\n    dispatch({\n      type: 'set_camera_active',\n      payload: param\n    });\n  }\n}))(Screen);","map":{"version":3,"sources":["/home/saint/ek 3.1/ek-lc-dev/src/m_screen/foto.js"],"names":["React","CameraPhoto","FACING_MODES","connect","foto","Screen","Component","constructor","props","context","cameraPhoto","videoRef","createRef","componentDidMount","current","componentWillUnmount","stopCamera","take_foto","startCamera","idealFacingMode","idealResolution","then","console","log","catch","error","camera_active","takePhoto","config","sizeFactor","dataUri","getDataUri","render","store","disp","cameraActive","facingMode","ENVIRONMENT","width","height","state","dispatch","param","type","payload"],"mappings":"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","sourcesContent":["import React from 'react';\nimport CameraPhoto, { FACING_MODES } from 'jslib-html5-camera-photo';\nimport { connect } from 'react-redux';\nimport './mobile.css';\nimport foto from '../common/foto.png';\n\nclass Screen extends React.Component {\n    constructor(props, context) {\n        super(props, context);\n\n        this.cameraPhoto = null;\n        this.videoRef = React.createRef();\n    }\n\n    componentDidMount() {\n        this.cameraPhoto = new CameraPhoto(this.videoRef.current);\n    }\n\n    componentWillUnmount() {\n        this.stopCamera();\n        this.props.take_foto('');\n    }\n\n    startCamera(idealFacingMode, idealResolution) {\n\n        this.cameraPhoto.startCamera(idealFacingMode, idealResolution)\n            .then(() => {\n                console.log('camera is started !');\n            })\n            .catch((error) => {\n                console.error('Camera not started!', error);\n            });\n        \n        this.props.camera_active(true);\n    }\n\n    takePhoto() {\n        const config = {\n            sizeFactor: 1\n        };\n        let dataUri = this.cameraPhoto.getDataUri(config);\n        \n        this.props.take_foto(dataUri);\n        this.stopCamera();\n    }\n\n    stopCamera() {\n        this.props.camera_active(false);\n        this.cameraPhoto.stopCamera()\n            .then(() => {\n                console.log('Camera stoped!');\n            })\n            .catch((error) => {\n                console.log('No camera to stop!:', error);\n            });\n    }\n\n    render() {\n\n        return (\n            <div className=\"mobile_container\">\n                <div className=\"mobile_button_container\">\n                    <button className={this.props.store.disp.cameraActive || this.props.store.disp.foto ? 'none' : 'camera_button'} onClick={() => {\n                        let facingMode = FACING_MODES.ENVIRONMENT;\n                        let idealResolution = { width: 1280, height: 1280 };\n                        this.props.camera_active(true);\n                        this.startCamera(facingMode, idealResolution);\n                    }}>Включить Камеру</button>\n\n                    <button className={this.props.store.disp.cameraActive ? 'camera_button' : 'none'} onClick={() => {\n                        this.stopCamera();\n                    }}>Выключить Камеру</button>\n\n                    <button className={this.props.store.disp.foto ? 'camera_button' : 'none'} onClick={() => {\n                        let facingMode = FACING_MODES.ENVIRONMENT;\n                        let idealResolution = { width: 1280, height: 1280 };\n                        this.props.take_foto('');\n                        this.props.camera_active(true);\n                        this.startCamera(facingMode, idealResolution);\n                    }}>Переснять</button>\n                </div>\n\n                <div className={this.props.store.disp.cameraActive ? \"video_container\" : \"none\"}>\n                    <video className={this.props.store.disp.cameraActive ? \"foto\" : \"none\"} ref={this.videoRef} autoPlay = {true}/>\n                    \n                    <img className={this.props.store.disp.cameraActive ? \"video_button\" : \"none\"} src={foto} onClick={() => {this.takePhoto()}} />\n\n                </div>\n                <img\n                    className=\"foto\"\n                    src={this.props.store.disp.foto}\n                />\n\n            </div>\n        );\n    }\n} \n\nexport default connect(\n    (state) => ({ store: state }),\n    dispatch => ({\n        take_foto: (param) => { dispatch({ type: 'set_disp_foto', payload: param }) },\n        camera_active: (param) => { dispatch({ type: 'set_camera_active', payload: param }) },\n    })\n)(Screen);"]},"metadata":{},"sourceType":"module"}