{"ast":null,"code":"var _jsxFileName = \"/home/saint/ek 3.1/ek-lc-dev/src/m_screen/m_storage.js\";\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport './mobile.css';\nimport './mobile_storage.css';\nimport { get_data } from '../common/common_modules';\nimport update from '../common/update.png';\nimport scanner from '../common/scanner.png';\nimport { withCookies } from 'react-cookie';\nimport Wait from \"../screen/wait\";\nimport Scanner from \"./scanner\"; // const socket = new WebSocket('wss://echo.websocket.org');\n\nclass Screen extends React.Component {\n  constructor(...args) {\n    super(...args);\n\n    this.settings_window = window => {\n      this.props.set_active_window(window);\n    };\n\n    this.tr_click = async disp => {\n      const data = {\n        userkey: this.props.store.login.userkey,\n        status: disp.Type,\n        num: disp.Number\n      };\n      this.props.set_key(data);\n      this.props.set_active_window(\"m_disp\");\n    };\n\n    this.update = () => {\n      this.props.set_active_window(\"wait\");\n      const list_data = {\n        userkey: this.props.store.login.userkey\n      };\n      get_data('list', list_data).then(result => {\n        this.props.set_list_storage(result);\n        this.props.set_active_window(\"m_storage\");\n        this.props.set_search_storagre(\"\");\n      }, err => {\n        console.log(err);\n      });\n    };\n\n    this.disp_type = disp => {\n      let disp_bg = \"\";\n\n      if (disp.Status === 'Отменена') {\n        disp_bg = \"mobile_storage_item mobile_storage_item--canceling\";\n      } else if (disp.Type === 'Заявка') {\n        disp_bg = 'mobile_storage_item mobile_storage_item--applications';\n      } else {\n        disp_bg = \"mobile_storage_item\";\n      }\n\n      return disp_bg;\n    };\n\n    this.showNotification = () => {\n      const notification = new Notification(\"New message!\", {\n        body: \"Test message\",\n        requireInteraction: true,\n        icon: \"../wait.svg\"\n      });\n\n      notification.onclick = e => {\n        this.settings_window(\"m_disp\");\n      };\n    };\n  }\n\n  componentDidMount() {\n    // socket.onopen = () => {\n    //     console.log('WebSocket Client Connected');\n    //     console.log(socket)\n    // };\n    // socket.onmessage = (message) => {\n    //     console.log(message);\n    // };\n    if (this.props.cookies.get('num')) {\n      this.props.cookies.remove('num');\n    }\n\n    if (this.props.cookies.get('status')) {\n      this.props.cookies.remove('status');\n    }\n\n    if (this.props.cookies.get('window')) {\n      this.props.cookies.remove('window');\n    } // if ('serviceWorker' in navigator) {\n    //     navigator.serviceWorker.register('/sw.js').then(function (registration) {\n    //         console.log('ServiceWorker registration successful');\n    //     }, function (err) {\n    //         console.log('ServiceWorker registration failed: ', err);\n    //     });\n    // }\n    // if (Notification.permission === \"granted\") {\n    //     this.showNotification();\n    // } else if (Notification.permission === \"denied\" || \"default\") {\n    //     Notification.requestPermission().then(permission => {\n    //         if(permission === \"granted\") {\n    //             this.showNotification();\n    //         }\n    //     })\n    // }\n\n\n    this.props.set_active_loader(true);\n    const list_data = {\n      userkey: this.props.store.login.userkey\n    };\n    get_data('list', list_data).then(result => {\n      this.props.set_list_storage(result);\n      this.props.set_active_loader(false);\n      this.props.set_search_storagre(\"\");\n    }, err => {\n      console.log(err);\n    });\n  }\n\n  componentWillUnmount() {\n    this.props.set_scann_active(false);\n    this.props.set_search_reciept(\"\");\n    this.props.set_last_window(\"m_storage\");\n  }\n\n  render() {\n    window.history.pushState(null, \"\", window.location.href);\n\n    window.onpopstate = function () {\n      this.settings_window('Mmenu');\n      window.history.pushState(null, \"\", window.location.href);\n    }.bind(this);\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mobile_heading\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 17\n      }\n    }, \"\\u0414\\u043E\\u0441\\u0442\\u0430\\u0432\\u043A\\u0438 \\u0438 \\u0417\\u0430\\u044F\\u0432\\u043A\\u0438\"), this.props.store.general.active_loader ? /*#__PURE__*/React.createElement(Wait, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 60\n      }\n    }) : /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mobile_storage\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mobile_container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mobile_search\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mobile_search_label\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 29\n      }\n    }, \"\\u041F\\u043E\\u0438\\u0441\\u043A:\"), /*#__PURE__*/React.createElement(\"input\", {\n      className: \"mobile_search_input\",\n      value: this.props.store.storage.search,\n      onChange: e => {\n        this.props.set_search_storagre(e.target.value);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 29\n      }\n    }), /*#__PURE__*/React.createElement(\"img\", {\n      src: update,\n      className: \"update\",\n      onClick: this.update.bind(this),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 29\n      }\n    }), /*#__PURE__*/React.createElement(\"img\", {\n      src: scanner,\n      className: \"update\",\n      onClick: e => this.props.set_scann_active(!this.props.store.storage.scann_active),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 29\n      }\n    })), this.props.store.storage.scann_active ? /*#__PURE__*/React.createElement(Scanner, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 29\n      }\n    }) : null, this.props.store.storage.list.filter(el => {\n      const filter_num = el.Number.toUpperCase();\n      const filter_adress = el.Adress.toUpperCase();\n      const text = this.props.store.storage.search.toUpperCase();\n      return text === \"\" || filter_num.indexOf(text) > -1 || filter_adress.indexOf(text) > -1;\n    }).map((disp, index) => /*#__PURE__*/React.createElement(\"div\", {\n      key: index,\n      onClick: this.tr_click.bind(this, disp),\n      className: disp.Status === 'Отмена' ? \"mobile_storage_item mobile_storage_item--canceling\" : disp.Type === 'Заявка' ? disp.Status === 'Новая' ? 'mobile_storage_item mobile_storage_item--new' : 'mobile_storage_item mobile_storage_item--applications' : \"mobile_storage_item\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mobile_storage_data\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mobile_storage_field\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 37\n      }\n    }, disp.Customer), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mobile_storage_field\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 37\n      }\n    }, disp.Date), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mobile_storage_field\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 37\n      }\n    }, disp.Type, \" \", disp.Number), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mobile_storage_field\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 37\n      }\n    }, disp.reccity, \" \", disp.Adress), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mobile_storage_field\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 37\n      }\n    }, disp.Phone, \" \", disp.Person), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mobile_storage_field\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 37\n      }\n    }, disp.AddInfo)), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mobile_storage_item_row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mobile_storage_field\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 37\n      }\n    }, disp.Status, /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 88\n      }\n    }), disp.Time), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mobile_storage_field\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"b\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 75\n      }\n    }, disp.COD, \" \\u0440\\u0443\\u0431.\"))))))));\n  }\n\n}\n\n;\nexport default withCookies(connect(state => ({\n  store: state\n}), dispatch => ({\n  set_scann_active: param => {\n    dispatch({\n      type: 'set_scann_active',\n      payload: param\n    });\n  },\n  set_key: param => {\n    dispatch({\n      type: 'set_key',\n      payload: param\n    });\n  },\n  set_data_disp: param => {\n    dispatch({\n      type: 'set_data_disp',\n      payload: param\n    });\n  },\n  set_last_window: () => {\n    dispatch({\n      type: 'set_last_window',\n      payload: \"storage\"\n    });\n  },\n  set_active_window: param => {\n    dispatch({\n      type: 'set_active_window',\n      payload: param\n    });\n  },\n  set_action: param => {\n    dispatch({\n      type: 'set_action',\n      payload: param\n    });\n  },\n  set_search_storagre: param => {\n    dispatch({\n      type: 'set_search_storagre',\n      payload: param\n    });\n  },\n  set_list_storage: param => {\n    dispatch({\n      type: 'set_list_storage',\n      payload: param\n    });\n  },\n  set_active_loader: param => {\n    dispatch({\n      type: 'set_active_loader',\n      payload: param\n    });\n  },\n  set_search_reciept: param => {\n    dispatch({\n      type: 'set_search_reciept',\n      payload: param\n    });\n  }\n}))(Screen));","map":{"version":3,"sources":["/home/saint/ek 3.1/ek-lc-dev/src/m_screen/m_storage.js"],"names":["React","connect","get_data","update","scanner","withCookies","Wait","Scanner","Screen","Component","settings_window","window","props","set_active_window","tr_click","disp","data","userkey","store","login","status","Type","num","Number","set_key","list_data","then","result","set_list_storage","set_search_storagre","err","console","log","disp_type","disp_bg","Status","showNotification","notification","Notification","body","requireInteraction","icon","onclick","e","componentDidMount","cookies","get","remove","set_active_loader","componentWillUnmount","set_scann_active","set_search_reciept","set_last_window","render","history","pushState","location","href","onpopstate","bind","general","active_loader","storage","search","target","value","scann_active","list","filter","el","filter_num","toUpperCase","filter_adress","Adress","text","indexOf","map","index","Customer","Date","reccity","Phone","Person","AddInfo","Time","COD","state","dispatch","param","type","payload","set_data_disp","set_action"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { connect } from 'react-redux';\nimport './mobile.css';\nimport './mobile_storage.css';\nimport { get_data } from '../common/common_modules';\nimport update from '../common/update.png';\nimport scanner from '../common/scanner.png';\nimport { withCookies } from 'react-cookie';\nimport Wait from \"../screen/wait\";\nimport Scanner from \"./scanner\";\n// const socket = new WebSocket('wss://echo.websocket.org');\n\nclass Screen extends React.Component {\n\n    settings_window = (window) => {\n        this.props.set_active_window(window);\n    }\n\n    tr_click = async (disp) => {\n\n        const data = {\n            userkey: this.props.store.login.userkey,\n            status: disp.Type,\n            num: disp.Number,\n        };\n\n        this.props.set_key(data);\n        this.props.set_active_window(\"m_disp\");\n\n    };\n\n    update = () => {\n        this.props.set_active_window(\"wait\");\n        const list_data = { userkey: this.props.store.login.userkey };\n\n        get_data('list', list_data).then(\n            (result) => {\n                this.props.set_list_storage(result);\n                this.props.set_active_window(\"m_storage\");\n                this.props.set_search_storagre(\"\");\n            },\n            (err) => { console.log(err) }\n        );\n    }\n\n    disp_type = (disp) => {\n        let disp_bg = \"\";\n        if (disp.Status === 'Отменена') {\n            disp_bg = \"mobile_storage_item mobile_storage_item--canceling\";\n        } else if (disp.Type === 'Заявка') {\n            disp_bg = 'mobile_storage_item mobile_storage_item--applications';\n        } else {\n            disp_bg = \"mobile_storage_item\";\n        }\n        return disp_bg;\n    }\n\n    showNotification = () => {\n        const notification = new Notification(\"New message!\", {\n            body: \"Test message\",\n            requireInteraction: true,\n            icon: \"../wait.svg\",\n        });\n\n        notification.onclick = (e) => {\n            this.settings_window(\"m_disp\")\n        }\n    }\n\n    componentDidMount() {\n        // socket.onopen = () => {\n        //     console.log('WebSocket Client Connected');\n        //     console.log(socket)\n        // };\n        // socket.onmessage = (message) => {\n        //     console.log(message);\n        // };\n\n        if (this.props.cookies.get('num')) {\n            this.props.cookies.remove('num');\n        }\n        if (this.props.cookies.get('status')) {\n            this.props.cookies.remove('status');\n        }\n        if (this.props.cookies.get('window')) {\n            this.props.cookies.remove('window');\n        }\n\n        // if ('serviceWorker' in navigator) {\n        //     navigator.serviceWorker.register('/sw.js').then(function (registration) {\n        //         console.log('ServiceWorker registration successful');\n        //     }, function (err) {\n        //         console.log('ServiceWorker registration failed: ', err);\n        //     });\n        // }\n\n        // if (Notification.permission === \"granted\") {\n        //     this.showNotification();\n        // } else if (Notification.permission === \"denied\" || \"default\") {\n        //     Notification.requestPermission().then(permission => {\n        //         if(permission === \"granted\") {\n        //             this.showNotification();\n        //         }\n        //     })\n        // }\n\n        this.props.set_active_loader(true);\n\n        const list_data = { userkey: this.props.store.login.userkey };\n\n        get_data('list', list_data).then(\n            (result) => {\n                this.props.set_list_storage(result);\n                this.props.set_active_loader(false);\n                this.props.set_search_storagre(\"\");\n            },\n            (err) => { console.log(err) }\n        );\n    }\n\n    componentWillUnmount() {\n        this.props.set_scann_active(false);\n        this.props.set_search_reciept(\"\");\n        this.props.set_last_window(\"m_storage\");\n    }\n\n    render() {\n\n        window.history.pushState(null, \"\", window.location.href);\n        window.onpopstate = function () {\n            this.settings_window('Mmenu')\n            window.history.pushState(null, \"\", window.location.href);\n        }.bind(this);\n\n        return (\n            <div>\n                <div className=\"mobile_heading\">\n                    Доставки и Заявки\n                </div>\n                {this.props.store.general.active_loader ? (<Wait />) : (\n                <div className=\"mobile_storage\">\n                    <div className=\"mobile_container\">\n\n                        <div className=\"mobile_search\">\n                            <div className=\"mobile_search_label\">\n                                Поиск:\n                            </div>\n                            <input className=\"mobile_search_input\" value={this.props.store.storage.search} onChange={(e) => { this.props.set_search_storagre(e.target.value) }} />\n                            <img src={update} className=\"update\" onClick={this.update.bind(this)} />\n                            <img src={scanner} className=\"update\" onClick={e => this.props.set_scann_active(!this.props.store.storage.scann_active)} />\n                        </div>\n\n                        {this.props.store.storage.scann_active ? (\n                            <Scanner />\n                        ) : (null)}\n\n                        {this.props.store.storage.list.filter((el) => {\n                            const filter_num = el.Number.toUpperCase()\n                            const filter_adress = el.Adress.toUpperCase()\n                            const text = this.props.store.storage.search.toUpperCase()\n                            return text === \"\" || filter_num.indexOf(text) > -1 || filter_adress.indexOf(text) > -1\n                        }).map((disp, index) =>\n                            \n                            <div key={index} onClick={this.tr_click.bind(this, disp)} \n                            className={(disp.Status === 'Отмена') ? \"mobile_storage_item mobile_storage_item--canceling\" : \n                                (disp.Type === 'Заявка') ? ((disp.Status === 'Новая') ? ('mobile_storage_item mobile_storage_item--new') : ('mobile_storage_item mobile_storage_item--applications')) :\n                                    (\"mobile_storage_item\")}>\n                                <div className=\"mobile_storage_data\">\n                                    <div className=\"mobile_storage_field\">{disp.Customer}</div>\n                                    <div className=\"mobile_storage_field\">{disp.Date}</div>\n                                    <div className=\"mobile_storage_field\">{disp.Type} {disp.Number}</div>\n                                    <div className=\"mobile_storage_field\">{disp.reccity} {disp.Adress}</div>\n                                    <div className=\"mobile_storage_field\">{disp.Phone} {disp.Person}</div>\n                                    <div className=\"mobile_storage_field\">{disp.AddInfo}</div>\n                                </div>\n                                <div className=\"mobile_storage_item_row\">\n                                    <div className=\"mobile_storage_field\">{disp.Status}<br />{disp.Time}</div>\n                                    \n                                    <div className=\"mobile_storage_field\"><b>{disp.COD} руб.</b></div>\n                                </div>\n                            </div>\n\n                        )}\n                    </div>\n                </div>\n                )}\n            </div>\n        )\n    }\n};\n\n\nexport default withCookies(connect(\n    state => ({\n        store: state\n    }),\n    dispatch => ({\n        set_scann_active: (param) => { dispatch({ type: 'set_scann_active', payload: param }) },\n        set_key: (param) => { dispatch({ type: 'set_key', payload: param }) },\n        set_data_disp: (param) => { dispatch({ type: 'set_data_disp', payload: param }) },\n        set_last_window: () => { dispatch({ type: 'set_last_window', payload: \"storage\" }) },\n        set_active_window: (param) => { dispatch({ type: 'set_active_window', payload: param }) },\n        set_action: (param) => { dispatch({ type: 'set_action', payload: param }) }, \n        set_search_storagre: (param) => { dispatch({ type: 'set_search_storagre', payload: param }) }, \n        set_list_storage: (param) => { dispatch({ type: 'set_list_storage', payload: param }) },\n        set_active_loader: (param) => { dispatch({ type: 'set_active_loader', payload: param }) },\n        set_search_reciept: (param) => { dispatch({ type: 'set_search_reciept', payload: param }) },\n    })\n)(Screen));"]},"metadata":{},"sourceType":"module"}