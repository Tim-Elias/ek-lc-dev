{"ast":null,"code":"var _jsxFileName = \"/home/saint/123/ek-lc-dev/src/m_screen/foto.js\";\nimport React from 'react';\nimport CameraPhoto, { FACING_MODES } from 'jslib-html5-camera-photo';\nimport { connect } from 'react-redux';\nimport './mobile.css';\nimport foto from '../common/foto.png';\nimport { get_data } from './../common/common_modules';\n\nclass Screen extends React.Component {\n  constructor(props, context) {\n    super(props, context);\n    this.cameraPhoto = null;\n    this.videoRef = React.createRef();\n  }\n\n  componentDidMount() {\n    let facingMode = FACING_MODES.ENVIRONMENT;\n    let idealResolution = {\n      width: 1280,\n      height: 1280\n    };\n    this.cameraPhoto = new CameraPhoto(this.videoRef.current);\n    this.startCamera(facingMode, idealResolution);\n  }\n\n  componentWillUnmount() {\n    this.stopCamera();\n    this.props.take_foto('');\n  }\n\n  startCamera(idealFacingMode, idealResolution) {\n    this.cameraPhoto.startCamera(idealFacingMode, idealResolution).then(() => {\n      console.log('camera is started !');\n    }).catch(error => {\n      console.error('Camera not started!', error);\n    });\n    this.props.camera_active(true);\n  }\n\n  takePhoto() {\n    const config = {\n      sizeFactor: 1\n    };\n    let dataUri = this.cameraPhoto.getDataUri(config);\n    this.props.take_foto(dataUri.split(',').pop());\n    this.stopCamera();\n  }\n\n  stopCamera() {\n    this.props.camera_active(false);\n    this.cameraPhoto.stopCamera().then(() => {\n      console.log('Camera stoped!');\n    }).catch(error => {\n      console.log('No camera to stop!:', error);\n    });\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"mobile_container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 65\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"mobile_button_container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: this.props.store.disp.cameraActive || this.props.store.disp.foto ? 'none' : 'camera_button',\n      onClick: () => {\n        let facingMode = FACING_MODES.ENVIRONMENT;\n        let idealResolution = {\n          width: 1280,\n          height: 1280\n        };\n        this.props.camera_active(true);\n        this.startCamera(facingMode, idealResolution);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67\n      },\n      __self: this\n    }, \"\\u0412\\u043A\\u043B\\u044E\\u0447\\u0438\\u0442\\u044C \\u041A\\u0430\\u043C\\u0435\\u0440\\u0443\"), React.createElement(\"button\", {\n      className: this.props.store.disp.cameraActive ? 'camera_button' : 'none',\n      onClick: () => {\n        this.stopCamera();\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74\n      },\n      __self: this\n    }, \"\\u0412\\u044B\\u043A\\u043B\\u044E\\u0447\\u0438\\u0442\\u044C \\u041A\\u0430\\u043C\\u0435\\u0440\\u0443\"), React.createElement(\"button\", {\n      className: this.props.store.disp.foto ? 'camera_button' : 'none',\n      onClick: () => {\n        let facingMode = FACING_MODES.ENVIRONMENT;\n        let idealResolution = {\n          width: 1280,\n          height: 1280\n        };\n        this.props.take_foto('');\n        this.props.camera_active(true);\n        this.startCamera(facingMode, idealResolution);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78\n      },\n      __self: this\n    }, \"\\u041F\\u0435\\u0440\\u0435\\u0441\\u043D\\u044F\\u0442\\u044C\")), React.createElement(\"div\", {\n      className: this.props.store.disp.cameraActive ? \"video_container\" : \"none\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87\n      },\n      __self: this\n    }, React.createElement(\"video\", {\n      className: this.props.store.disp.cameraActive ? \"foto\" : \"none\",\n      ref: this.videoRef,\n      autoPlay: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88\n      },\n      __self: this\n    }), React.createElement(\"img\", {\n      className: this.props.store.disp.cameraActive ? \"video_button\" : \"none\",\n      src: foto,\n      onClick: () => {\n        this.takePhoto();\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90\n      },\n      __self: this\n    })), React.createElement(\"img\", {\n      className: \"foto\",\n      src: this.props.store.disp.foto,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93\n      },\n      __self: this\n    }));\n  }\n\n}\n\nexport default connect(state => ({\n  store: state\n}), dispatch => ({\n  take_foto: param => {\n    dispatch({\n      type: 'set_disp_foto',\n      payload: param\n    });\n  },\n  camera_active: param => {\n    dispatch({\n      type: 'set_camera_active',\n      payload: param\n    });\n  }\n}))(Screen);","map":{"version":3,"sources":["/home/saint/123/ek-lc-dev/src/m_screen/foto.js"],"names":["React","CameraPhoto","FACING_MODES","connect","foto","get_data","Screen","Component","constructor","props","context","cameraPhoto","videoRef","createRef","componentDidMount","facingMode","ENVIRONMENT","idealResolution","width","height","current","startCamera","componentWillUnmount","stopCamera","take_foto","idealFacingMode","then","console","log","catch","error","camera_active","takePhoto","config","sizeFactor","dataUri","getDataUri","split","pop","render","store","disp","cameraActive","state","dispatch","param","type","payload"],"mappings":"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","sourcesContent":["import React from 'react';\nimport CameraPhoto, { FACING_MODES } from 'jslib-html5-camera-photo';\nimport { connect } from 'react-redux';\nimport './mobile.css';\nimport foto from '../common/foto.png';\nimport { get_data } from './../common/common_modules';\n\nclass Screen extends React.Component {\n    constructor(props, context) {\n        super(props, context);\n\n        this.cameraPhoto = null;\n        this.videoRef = React.createRef();\n    }\n\n    componentDidMount() {\n        let facingMode = FACING_MODES.ENVIRONMENT;\n        let idealResolution = { width: 1280, height: 1280 };\n        this.cameraPhoto = new CameraPhoto(this.videoRef.current);\n        this.startCamera(facingMode, idealResolution);\n    }\n\n    componentWillUnmount() {\n        this.stopCamera();\n        this.props.take_foto('');\n    }\n\n    startCamera(idealFacingMode, idealResolution) {\n\n        this.cameraPhoto.startCamera(idealFacingMode, idealResolution)\n            .then(() => {\n                console.log('camera is started !');\n            })\n            .catch((error) => {\n                console.error('Camera not started!', error);\n            });\n        \n        this.props.camera_active(true);\n    }\n\n    takePhoto() {\n        const config = {\n            sizeFactor: 1\n        };\n        let dataUri = this.cameraPhoto.getDataUri(config);\n        \n        this.props.take_foto(dataUri.split(',').pop());\n        this.stopCamera();\n    }\n\n    stopCamera() {\n        this.props.camera_active(false);\n        this.cameraPhoto.stopCamera()\n            .then(() => {\n                console.log('Camera stoped!');\n            })\n            .catch((error) => {\n                console.log('No camera to stop!:', error);\n            });\n    }\n\n    render() {\n\n        return (\n            <div className=\"mobile_container\">\n                <div className=\"mobile_button_container\">\n                    <button className={this.props.store.disp.cameraActive || this.props.store.disp.foto ? 'none' : 'camera_button'} onClick={() => {\n                        let facingMode = FACING_MODES.ENVIRONMENT;\n                        let idealResolution = { width: 1280, height: 1280 };\n                        this.props.camera_active(true);\n                        this.startCamera(facingMode, idealResolution);\n                    }}>Включить Камеру</button>\n\n                    <button className={this.props.store.disp.cameraActive ? 'camera_button' : 'none'} onClick={() => {\n                        this.stopCamera();\n                    }}>Выключить Камеру</button>\n\n                    <button className={this.props.store.disp.foto ? 'camera_button' : 'none'} onClick={() => {\n                        let facingMode = FACING_MODES.ENVIRONMENT;\n                        let idealResolution = { width: 1280, height: 1280 };\n                        this.props.take_foto('');\n                        this.props.camera_active(true);\n                        this.startCamera(facingMode, idealResolution);\n                    }}>Переснять</button>\n                </div>\n\n                <div className={this.props.store.disp.cameraActive ? \"video_container\" : \"none\"}>\n                    <video className={this.props.store.disp.cameraActive ? \"foto\" : \"none\"} ref={this.videoRef} autoPlay = {true}/>\n                    \n                    <img className={this.props.store.disp.cameraActive ? \"video_button\" : \"none\"} src={foto} onClick={() => {this.takePhoto()}} />\n\n                </div>\n                <img\n                    className=\"foto\"\n                    src={this.props.store.disp.foto}\n                />\n\n            </div>\n        );\n    }\n} \n\nexport default connect(\n    (state) => ({ store: state }),\n    dispatch => ({\n        take_foto: (param) => { dispatch({ type: 'set_disp_foto', payload: param }) },\n        camera_active: (param) => { dispatch({ type: 'set_camera_active', payload: param }) },\n    })\n)(Screen);"]},"metadata":{},"sourceType":"module"}