{"ast":null,"code":"var _jsxFileName = \"/home/saint/ek 3.1/ek-lc-dev/src/m_screen/m_send_partner.js\";\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport '../screen/send_manifest.css';\nimport '../App.css';\nimport { get_data } from './../common/common_modules';\nimport Wait from \"../screen/wait\";\nimport { Item } from 'semantic-ui-react';\n\nclass Screen extends React.Component {\n  constructor(...args) {\n    super(...args);\n\n    this.send_manifest = () => {\n      this.props.set_active_window(\"wait\");\n      const dispatches = this.props.store.storage.list.filter(el => {\n        if (el.selected) return el;\n      }).map(disp => {\n        return disp.Number;\n      });\n      const data = {\n        userkey: this.props.store.login.userkey,\n        dispatches: dispatches,\n        customer_key: this.props.store.send_manifest.select_customer\n      };\n      get_data('sendmanifest', data).then(result => {\n        get_data('list', {\n          userkey: this.props.store.login.userkey\n        }).then(result => {\n          this.props.set_list_storage(result);\n          this.props.set_active_window(\"Mmenu\");\n        }, err => {\n          this.props.set_active_window(\"Mmenu\");\n          console.log(err);\n        });\n      }, err => {\n        this.props.set_active_window(\"send_manifest\");\n        alert(err);\n      });\n    };\n  }\n\n  componentDidMount() {\n    this.props.set_select_customer(this.props.store.login.customers[0].customerKey);\n    this.props.set_active_loader(true);\n    const list_data = {\n      userkey: this.props.store.login.userkey\n    };\n    get_data('list', list_data).then(result => {\n      this.props.set_list_storage(result);\n      this.props.set_active_loader(false);\n    }, err => {\n      console.log(err);\n      this.props.set_active_loader(false);\n    });\n  }\n\n  render() {\n    const search = () => {\n      this.search();\n    };\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mobile_heading\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 17\n      }\n    }, \"\\u041F\\u0435\\u0440\\u0435\\u0434\\u0430\\u0442\\u044C \\u043F\\u0430\\u0440\\u0442\\u043D\\u0435\\u0440\\u0443\"), this.props.store.general.active_loader ? /*#__PURE__*/React.createElement(Wait, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 60\n      }\n    }) : /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mobile_container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"select\", {\n      className: \"mobile_select\",\n      defaultValue: this.props.store.send_manifest.select_customer,\n      value: this.props.store.send_manifest.select_customer_key,\n      onChange: e => this.props.set_select_customer_key(e.target.value),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 25\n      }\n    }, this.props.store.login.customers.map(item => /*#__PURE__*/React.createElement(\"option\", {\n      value: item.customerKey,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 78\n      }\n    }, item.customer))), this.props.store.storage.list.filter(el => {\n      const filter_num = el.Number.toUpperCase();\n      const filter_adress = el.Adress.toUpperCase();\n      const text = this.props.store.storage.search.toUpperCase();\n      return text === \"\" || filter_num.indexOf(text) > -1 || filter_adress.indexOf(text) > -1;\n    }).filter(item => item.Type === \"Доставка\").map((disp, index) => /*#__PURE__*/React.createElement(\"div\", {\n      onClick: e => this.props.select_m_disp(disp.Number),\n      key: index,\n      className: \"mobile_storage_item\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"checkbox\",\n      className: \"mobile_storage_checkbox\",\n      checked: disp.selected,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 33\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mobile_storage_data\",\n      style: {\n        width: \"100%\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mobile_storage_field\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 37\n      }\n    }, disp.Customer), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mobile_storage_field\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 37\n      }\n    }, disp.Date), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mobile_storage_field\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 37\n      }\n    }, disp.Type, \" \", disp.Number), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mobile_storage_field\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 37\n      }\n    }, disp.reccity, \" \", disp.Adress), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mobile_storage_field\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 37\n      }\n    }, disp.Phone, \" \", disp.Person), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mobile_storage_field\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 37\n      }\n    }, disp.AddInfo)), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mobile_storage_item_row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mobile_storage_field\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 37\n      }\n    }, disp.Status, /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 88\n      }\n    }), disp.Time), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mobile_storage_field\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"b\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 75\n      }\n    }, disp.COD, \" \\u0440\\u0443\\u0431.\"))))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"disp_data_el\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 25\n      }\n    }, \"\\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C \\u043D\\u0430 \\u0441\\u043A\\u043B\\u0430\\u0434: \\u043D\\u0430\\u043A\\u043B\\u0430\\u0434\\u043D\\u044B\\u0445: \", this.props.store.storage.list.filter(el => {\n      if (el.selected) return el;\n    }).length, \" (\\u043C\\u0435\\u0441\\u0442: \", this.props.store.storage.list.filter(el => {\n      if (el.selected) return el;\n    }).reduce((sum, el) => {\n      return sum + parseInt(el.total);\n    }, 0), \")\"), /*#__PURE__*/React.createElement(\"button\", {\n      onClick: this.send_manifest.bind(this),\n      className: \"send_manifest\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 25\n      }\n    }, \"\\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C \\u0438 \\u0437\\u0430\\u043A\\u0440\\u044B\\u0442\\u044C\")));\n  }\n\n}\n\n;\nexport default connect(state => ({\n  store: state\n}), dispatch => ({\n  select_m_disp: param => {\n    dispatch({\n      type: 'select_m_disp',\n      payload: param\n    });\n  },\n  set_active_loader: param => {\n    dispatch({\n      type: 'set_active_loader',\n      payload: param\n    });\n  },\n  set_active_window: param => {\n    dispatch({\n      type: 'set_active_window',\n      payload: param\n    });\n  },\n  set_send_manifest_storehouse: param => {\n    dispatch({\n      type: 'set_send_manifest_storehouse',\n      payload: param\n    });\n  },\n  set_search_send_manifest: param => {\n    dispatch({\n      type: 'set_search_send_manifest',\n      payload: param\n    });\n  },\n  set_search_send_manifest_error: param => {\n    dispatch({\n      type: 'set_search_error',\n      payload: param\n    });\n  },\n  select_disp: param => {\n    dispatch({\n      type: 'select_disp',\n      payload: param\n    });\n  },\n  set_list_storage: param => {\n    dispatch({\n      type: 'set_list_storage',\n      payload: param\n    });\n  },\n  set_select_customer: param => {\n    dispatch({\n      type: 'set_select_customer',\n      payload: param\n    });\n  }\n}))(Screen);","map":{"version":3,"sources":["/home/saint/ek 3.1/ek-lc-dev/src/m_screen/m_send_partner.js"],"names":["React","connect","get_data","Wait","Item","Screen","Component","send_manifest","props","set_active_window","dispatches","store","storage","list","filter","el","selected","map","disp","Number","data","userkey","login","customer_key","select_customer","then","result","set_list_storage","err","console","log","alert","componentDidMount","set_select_customer","customers","customerKey","set_active_loader","list_data","render","search","general","active_loader","select_customer_key","e","set_select_customer_key","target","value","item","customer","filter_num","toUpperCase","filter_adress","Adress","text","indexOf","Type","index","select_m_disp","width","Customer","Date","reccity","Phone","Person","AddInfo","Status","Time","COD","length","reduce","sum","parseInt","total","bind","state","dispatch","param","type","payload","set_send_manifest_storehouse","set_search_send_manifest","set_search_send_manifest_error","select_disp"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { connect } from 'react-redux';\nimport '../screen/send_manifest.css';\nimport '../App.css';\nimport { get_data } from './../common/common_modules';\nimport Wait from \"../screen/wait\";\nimport { Item } from 'semantic-ui-react';\n\nclass Screen extends React.Component {\n\n\n    componentDidMount() {\n        this.props.set_select_customer(this.props.store.login.customers[0].customerKey)\n        this.props.set_active_loader(true);\n\n        const list_data = { userkey: this.props.store.login.userkey };\n\n        get_data('list', list_data).then(\n            (result) => {\n                this.props.set_list_storage(result);\n                this.props.set_active_loader(false);\n            },\n            (err) => {\n                console.log(err);\n                this.props.set_active_loader(false);\n            }\n        );\n    }\n\n    send_manifest = () => {\n\n        this.props.set_active_window(\"wait\");\n\n        const dispatches = this.props.store.storage.list.filter((el) => { if (el.selected) return el }).map((disp) => { return disp.Number })\n        const data = {\n            userkey: this.props.store.login.userkey,\n            dispatches: dispatches,\n            customer_key: this.props.store.send_manifest.select_customer,\n        };\n\n        get_data('sendmanifest', data).then(\n            (result) => {\n\n                get_data('list', { userkey: this.props.store.login.userkey }).then(\n                    (result) => {\n                        this.props.set_list_storage(result);\n                        this.props.set_active_window(\"Mmenu\");\n                    },\n\n                    (err) => {\n                        this.props.set_active_window(\"Mmenu\");\n                        console.log(err)\n                    }\n                );\n            },\n            (err) => {\n                this.props.set_active_window(\"send_manifest\");\n                alert(err)\n            }\n        );\n    }\n\n\n    render() {\n\n        const search = () => {\n            this.search();\n        };\n\n        return (\n            <div>\n                <div className=\"mobile_heading\">Передать партнеру</div>\n                {this.props.store.general.active_loader ? (<Wait />) : (\n                    <div className=\"mobile_container\">\n                        <select className=\"mobile_select\" defaultValue={this.props.store.send_manifest.select_customer} value={this.props.store.send_manifest.select_customer_key} onChange={e => this.props.set_select_customer_key(e.target.value)}>\n                            {this.props.store.login.customers.map((item) => (<option value={item.customerKey}>{item.customer}</option>))}\n                        </select>\n\n                        {this.props.store.storage.list.filter((el) => {\n                            const filter_num = el.Number.toUpperCase()\n                            const filter_adress = el.Adress.toUpperCase()\n                            const text = this.props.store.storage.search.toUpperCase()\n                            return text === \"\" || filter_num.indexOf(text) > -1 || filter_adress.indexOf(text) > -1\n                        }).filter((item) => (item.Type === \"Доставка\")).map((disp, index) =>\n                            <div onClick={e => this.props.select_m_disp(disp.Number)} key={index}\n                                className=\"mobile_storage_item\">\n                                <input type=\"checkbox\" className=\"mobile_storage_checkbox\" checked={disp.selected} />\n                                <div className=\"mobile_storage_data\" style={{ width: \"100%\" }}>\n                                    <div className=\"mobile_storage_field\">{disp.Customer}</div>\n                                    <div className=\"mobile_storage_field\">{disp.Date}</div>\n                                    <div className=\"mobile_storage_field\">{disp.Type} {disp.Number}</div>\n                                    <div className=\"mobile_storage_field\">{disp.reccity} {disp.Adress}</div>\n                                    <div className=\"mobile_storage_field\">{disp.Phone} {disp.Person}</div>\n                                    <div className=\"mobile_storage_field\">{disp.AddInfo}</div>\n                                </div>\n                                <div className=\"mobile_storage_item_row\">\n                                    <div className=\"mobile_storage_field\">{disp.Status}<br />{disp.Time}</div>\n\n                                    <div className=\"mobile_storage_field\"><b>{disp.COD} руб.</b></div>\n                                </div>\n                            </div>\n\n                        )}\n\n                        <div className=\"disp_data_el\">Отправить на склад: накладных: {this.props.store.storage.list.filter((el) => { if (el.selected) return el }).length} (мест: {this.props.store.storage.list.filter((el) => { if (el.selected) return el }).reduce((sum, el) => { return sum + parseInt(el.total) }, 0)})</div>\n                        <button onClick={this.send_manifest.bind(this)} className=\"send_manifest\">Отправить и закрыть</button>\n\n                    </div>\n                )}\n\n            </div>\n        );\n    }\n};\n\nexport default connect(\n    state => ({\n        store: state\n    }),\n    dispatch => ({\n        select_m_disp: (param) => { dispatch({ type: 'select_m_disp', payload: param }) },\n        set_active_loader: (param) => { dispatch({ type: 'set_active_loader', payload: param }) },\n        set_active_window: (param) => { dispatch({ type: 'set_active_window', payload: param }) },\n        set_send_manifest_storehouse: (param) => { dispatch({ type: 'set_send_manifest_storehouse', payload: param }) },\n        set_search_send_manifest: (param) => { dispatch({ type: 'set_search_send_manifest', payload: param }) },\n        set_search_send_manifest_error: (param) => { dispatch({ type: 'set_search_error', payload: param }) },\n\n        select_disp: (param) => { dispatch({ type: 'select_disp', payload: param }) },\n        set_list_storage: (param) => { dispatch({ type: 'set_list_storage', payload: param }) },\n        set_select_customer: (param) => { dispatch({ type: 'set_select_customer', payload: param }) },\n    })\n)(Screen);"]},"metadata":{},"sourceType":"module"}